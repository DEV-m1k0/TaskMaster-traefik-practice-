Отличная идея! Вот развернутое задание на разработку микросервисной архитектуры с использованием Python и Traefik. Оно охватывает все ключевые аспекты: создание сервисов, их контейнеризацию, оркестрацию и, главное, настройку шлюза.

### Задание: Разработка Системы Управления Задачами (TaskMaster) на основе Microservices

**Цель:** Создать простое, но функциональное backend-приложение, состоящее из нескольких независимых микросервисов. Взаимодействие между сервисами и внешним миром должно управляться с помощью **Traefik** как reverse proxy и API gateway.

---

### 1. Общее описание системы

Система состоит из трех основных сервисов:
1.  **Сервис Пользователей (auth-service):** Отвечает за аутентификацию и управление пользователями.
2.  **Сервис Задач (tasks-service):** Отвечает за CRUD-операции с задачами. Каждая задача принадлежит конкретному пользователю.
3.  **API Gateway (Traefik):** Единая точка входа для всех клиентов. Маршрутизирует запросы к соответствующим сервисам, снимая с них необходимость знать о существовании друг друга.

Дополнительно можно добавить сервис для логирования или нотификаций, чтобы продемонстрировать асинхронное взаимодействие (например, через RabbitMQ), но в рамках базового задания ограничимся тремя.

---

### 2. Технологический стек

*   **Язык:** Python 3.10+
*   **Фреймворки:** FastAPI (рекомендуется за простоту и асинхронность) или Flask.
*   **Контейнеризация:** Docker
*   **Оркестрация:** Docker Compose
*   **API Gateway / Reverse Proxy:** Traefik v2
*   **Хранение данных:** Каждый сервис использует свою собственную базу данных (для простоты можно использовать SQLite, но лучше PostgreSQL в отдельных контейнерах для демонстрации независимости).

---

### 3. Детальные требования к сервисам

#### Сервис 1: Auth-Service (`:8001`)
*   **Эндпоинты:**
    *   `POST /register` - Регистрация нового пользователя (email, password).
    *   `POST /login` - Аутентификация, возвращает простой JWT-токен (для демонстрации).
    *   `GET /users/me` - Возвращает информацию о текущем пользователе (требует валидный JWT в заголовке).
*   **База данных:** Таблица `users` (id, email, hashed_password, created_at).

#### Сервис 2: Tasks-Service (`:8002`)
*   **Эндпоинты:**
    *   `GET /tasks` - Возвращает все задачи текущего пользователя (требует JWT).
    *   `POST /tasks` - Создает новую задачу (title, description). Привязывает к user_id из JWT.
    *   `PUT /tasks/{task_id}` - Обновляет задачу.
    *   `DELETE /tasks/{task_id}` - Удаляет задачу.
*   **База данных:** Таблица `tasks` (id, title, description, user_id, created_at, is_completed).
*   **Зависимость:** Для валидации пользователя этот сервис должен декодировать JWT-токен. Можно вынести общую логику валидации в отдельную библиотеку или продублировать код (для простоты).

---

### 4. Ключевая роль Traefik

Traefik должен быть сконфигурирован для:
1.  **Обнаружения Сервисов (Service Discovery):** Автоматически находить запущенные контейнеры через Docker provider.
2.  **Маршрутизации (Routing):**
    *   Запросы, начинающиеся с `/api/auth/`, должны перенаправляться на контейнер `auth-service`.
    *   Запросы, начинающиеся с `/api/tasks/`, должны перенаправляться на контейнер `tasks-service`.
    *   Запросы к `api.taskmaster.localhost` должны перенаправляться на соответствующий сервис.
3.  **Балансировки Нагрузки (Load Balancing):** Если мы запустим несколько реплик `tasks-service`, Traefik должен балансировать нагрузку между ними.
4.  **Обработки HTTP-запросов:** Stripping prefix (чтобы `/api/auth/register` внутри auth-сервиса стал просто `/register`).

---